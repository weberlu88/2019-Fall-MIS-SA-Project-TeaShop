<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8">
<![endif]-->
<!--[if IE 9]>
<html class="ie ie9">
<![endif]-->
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<meta content="telephone=no" name="format-detection">
	<meta content="yes" name="apple-mobile-web-app-capable">
	<link href="apple-touch-icon.png" rel="apple-touch-icon">
	<link href="favicon.png" rel="icon">
	<meta content="" name="author">
	<meta content="" name="keywords">
	<meta content="" name="description">
	<title>編輯會員</title>
	<script src="https://kit.fontawesome.com/a076d05399.js">
	</script>
	<link href="https://fonts.googleapis.com/css?family=Kaushan+Script%7CLora:400,700" rel="stylesheet">
	<link href="plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="plugins/bakery-icon/style.css" rel="stylesheet">
	<link href="plugins/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="plugins/owl-carousel/assets/owl.carousel.css" rel="stylesheet">
	<link href="plugins/jquery-bar-rating/dist/themes/fontawesome-stars.css" rel="stylesheet">
	<link href="plugins/bootstrap-select/dist/css/bootstrap-select.min.css" rel="stylesheet">
	<link href="plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet">
	<link href="plugins/slick/slick/slick.css" rel="stylesheet">
	<link href="plugins/lightGallery-master/dist/css/lightgallery.min.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet"><!--HTML5 Shim and Respond.js IE8 support of HTML5 elements and media
queries-->
	<!--WARNING: Respond.js doesn't work if you view the page via file://-->
	<!--[if lt IE 9]>
    <script src="http://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js">
    </script>
    <script src="http://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js">
    </script>
<![endif]-->
	<!--[if IE 7]>
    
    <body class="ie7 lt-ie8 lt-ie9 lt-ie10">
    <![endif]-->
	<!--[if IE 8]>
        
        <body class="ie8 lt-ie9 lt-ie10">
        <![endif]-->
	<!--[if IE 9]>
            
            <body class="ie9 lt-ie10">
            <![endif]-->
</head>
<body>
	<div class="ps-search">
		<div class="ps-search__content">
			<a class="ps-search__close" href="#"><span></span></a>
			<form action="do_action" class="ps-form--search-2" method="post">
				<h3>Enter your keyword</h3>
				<div class="form-group">
					<input class="form-control" placeholder="" type="text"> <button class="ps-btn active ps-btn--fullwidth">Search</button>
				</div>
			</form>
		</div>
	</div><!-- Header-->
	<header class="header header--1" data-sticky="true">
		<nav class="navigation">
			<div class="ps-container">
				<div class="navigation__left">
					<img align="left" alt="" src="images/logo.png" width="10%">
					<ul class="menu">
						<li>
							<a href="index_administrant.html">Home</a>
						</li>
						<li>
							<a href="edit_order.html">view order</a>
						</li>
						<li>
							<a href="edit_member.html">view member</a>
						</li>
						<li>
							<a href="drink_edit.html">alter menu</a>
						</li>
						<li>
							<div class="ps-cart">
								<a class="ps-cart__toggle" href="#"><i class="ba-profile"></i></a>
								<div class="ps-cart__listing">
									<div class="ps-cart__content">
										<div class="ps-cart-item">
											<div class="ps-cart-item__content">
												<a class="ps-cart-item__title" href="index_customer.html">logout</a>
											</div>
										</div>
									</div>
								</div>
							</div>
						</li><!--<li><a href="#"><i class="ba-profile ">
                    </i></a></li>-->
					</ul>
				</div>
			</div>
		</nav>
	</header>
	<div class="ps-awards">
		<div class="ps-container">
			<div class="ps-section__header">
				<h3 class="ps-section__title">All Member List</h3>
				<p>Customer First</p><span><!-- 菜單背景圖片 -->
				 <img alt="" src="images/icons/floral.png"></span> <!-- 會員表格區 -->
				<div id="card_member"></div>
			</div>
		</div>
	</div><!-- Home 1 products-->
	<footer class="ps-footer">
		<div class="ps-footer__content">
			<div class="ps-container">
				<div class="row">
					<div class="col-lg-4 col-md-12 col-sm-12 col-xs-12">
						<div class="ps-site-info">
							<a class="ps-logo" href="index.html"><img alt="" src="images/logo-dark.png"></a>
							<p>Tart bear claw cake tiramisu chocolate bar gummies dragée lemon drops brownie.</p>
							<ul class="ps-list--social">
								<li>
									<a href="#"><i class="fa fa-facebook"></i></a>
								</li>
								<li>
									<a href="#"><i class="fa fa-twitter"></i></a>
								</li>
								<li>
									<a href="#"><i class="fa fa-dribbble"></i></a>
								</li>
							</ul>
						</div>
					</div>
					<div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
						<form class="ps-form--subscribe-offer">
							<h4>Get news & offer</h4>
							<div class="form-group">
								<input class="form-control" placeholder="Your Email..." type="text"> <button>Subscribe</button>
							</div>
							<p>* Don't worry, we never spam</p>
						</form>
						<div class="ps-footer__contact">
							<h4>Contact with me</h4>
							<p>PO Box 16122 Collins Street West,Victoria 8007 Australia</p>
							<p>(+84 ) 7534 9773, (+84 ) 874 548</p>
						</div>
					</div>
					<div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
						<div class="ps-footer__open">
							<h4>Time to Open</h4>
							<p>Monday - Friday:<br>
							08:00 am - 08:30 pm<br>
							Saturday - Sunday:<br>
							10:00 am - 16:30 pm</p>
						</div>
						<ul class="ps-list--payment">
							<li>
								<a href="#"><img alt="" src="images/payment-method/visa.png"></a>
							</li>
							<li>
								<a href="#"><img alt="" src="images/payment-method/master-card.png"></a>
							</li>
							<li>
								<a href="#"><img alt="" src="images/payment-method/paypal.png"></a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<div class="ps-footer__copyright">
			<div class="container"></div>
		</div>
	</footer><!-- Plugins-->
	<!-- javascript從下面開始 -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js">
	</script> 
	<script type="text/javascript">

	            var HTML_th = '<tr> <th>選項<\/th><th>會員編號<\/th><th>姓名<\/th><th>信箱<\/th><th>密碼<\/th><th>電話<\/th> <\/tr>'; // 表頭html
	            var data = ''; // ajax接收的資料
	            data = [ // 自己模擬接收到的資料
	                {
	                    "id":1,
	                    "name":"雅子",
	                    "email":"masako88@hotmail.com",
	                    "password":123456,
	                    "phone":0800000123
	                },
	                {
	                    "id":2,
	                    "name":"そら",
	                    "email":"sora77@live.com",
	                    "password":123456,
	                    "phone":0919876543
	                },
	                {
	                    "id":4,
	                    "name":"さとし",
	                    "email":"satoshi69@prxnhub.com",
	                    "password":123456,
	                    "phone":106403552
	                }
	            ];

	            $(document).ready(function () {

	                // console.log(HTML_th);
	                // console.log(data);

	                // 以表格動態顯示所有會員資料
	                // updateTable();
	                getAllMember();
	                
	                
	            });
	            
	            function getAllMember() {
	                // 發出POST的GET請求取得所有會員列表
	                $.ajax({
	                        type: "GET",
	                        url: "api/member.do",
	                        crossDomain: true,
	                        cache: false,
	                        dataType: 'json',
	                        timeout: 5000,
	                        success: function (response) {
	                            if(response.status == 200){
	                                console.log('Get member data successfully!');
	                                console.log(response.response);
	                                updateTable(response.response.data);
	                            }
	                            console.log(response);
	                        },
	                        error: function () {
	                            alert("無法連線到伺服器！");
	                        }
	                });
	            }
	            
	            function deleteMember(id){
	                console.log(id);
	                var deleteData = { "id" : id }
	                deleteData = JSON.stringify(deleteData);
	                // 使用ajax向server刪除該會員，刪除後重新用ajax GET
	                // 後端不能真的delete!!
	                $.ajax({
	                        type: "DELETE",
	                        url: "api/member.do",
	                        crossDomain: true,
	                        cache: false,
	                        dataType: 'json',
	                        data: deleteData,
	                        timeout: 5000,
	                        success: function (response) {
	                            if(response.status == 200){
	                                console.log('Delete member id='+ id +' successfully!');
	                                console.log(response.response);
	                                getAllMember();
	                            }
	                            console.log(response);
	                        },
	                        error: function () {
	                            alert("無法連線到伺服器！");
	                        }
	                });
	            }

	            function updateTable(data){
	                // 1.清空+表頭
	                $("#tblmember > tbody").empty();
	                let innerHTML="";
	                //innerHTML += HTML_th;

	                // 2.動態新增row至innerHTML字串
	                // $.each()用法 https://api.jquery.com/each/
	                // $.attr()可以設定屬性 https://api.jquery.com/attr/, https://stackoverflow.com/questions/5995628/adding-attribute-in-jquery
	                //取得的json格式 {id:int, name:str, phone:str, email:str, password:str, create:timestamp}
	                $(data).each(function( index, element ) {                      
	                    let row=""
	                    let image_src="images/user1.jpg";
	                    if(index%3===0)
	                    {
	                       row+="<tr>"     
	                       image_src="images/user2.jpg"
	                    }
	                    else if(index%3===1)
	                   {
	                       image_src="images/user3.jpg" 
	                   }
	                    
	                    row += "<td width='25%'><div id='card' class='ad_card_container'>"+
	                       "<div class='ad_card'><div class='card__image-container'>"+
	                       "<img class='card__image'src='"+image_src+"' alt=''><\/div>"+                                
	                       "<svg class='card__svg' viewBox='0 0 800 500'>"+                
	                           "<path"+
	                               " d='M 0 100 Q 50 200 100 250 Q 250 400 350 300 C 400 250 550 150 650 300 Q 750 450 800 400 L 800 500 L 0 500' stroke='transparent' fill='#333' />"+
	                           "<path class='card__line'"+
	                               " d='M 0 100 Q 50 200 100 250 Q 250 400 350 300 C 400 250 550 150 650 300 Q 750 450 800 400' stroke='yellow'stroke-width='3' fill='transparent' />"+
	                       "<\/svg><div class='card__content my_text'>";

	                    row += "<h2 id='name' class='card__title'>" + element["name"] + "<\/h2><p class='my_text' style='color:#aaa;font-size:16px'>";
	                    row += "<i class='fas fa-portrait'><\/i><span> <\/span><span id='user_id'>" + element["id"] + "<\/span> <br>";
	                    row += "<i class='glyphicon glyphicon-envelope'><\/i><span> <\/span><span id='mail'>" + element["email"] + "<\/span> <br>";
	                    row += "<i class='fas fa-key'><\/i><span> <\/span><span id='password'>" + element["password"] + "<\/span> <br>";
	                    row += "<i class='fas fa-phone'><\/i><span> <\/span><span id='phone'>" + element.phone + "<\/span> <br>";
	                    row += '<h3 style="color:gray"><a href="javascript:deleteMember('+ element.id + ');">刪除<\/a><\/h3>';
	                    row += "<\/div><\/div><\/div><\/td>";
	                   if(index%3===2)
	                   {
	                            row+="<\/tr>"                           
	                   }
	                    
	                    innerHTML += row;
	                });

	                // 3.把字串貼到網頁上
	                $("#card_member").html(innerHTML);
	            }
	</script> <!-- Plugins-->
	 
	<script src="plugins/jquery/dist/jquery.min.js">
	</script> 
	<script src="plugins/bootstrap/dist/js/bootstrap.min.js">
	</script> 
	<script src="plugins/owl-carousel/owl.carousel.min.js">
	</script> 
	<script src="plugins/bootstrap-select/dist/js/bootstrap-select.min.js">
	</script> 
	<script src="plugins/jquery-bar-rating/dist/jquery.barrating.min.js">
	</script> 
	<script src="plugins/jquery.waypoints.min.js">
	</script> 
	<script src="plugins/jquery.countTo.js">
	</script> 
	<script src="plugins/jquery.matchHeight-min.js">
	</script> 
	<script src="plugins/jquery-ui/jquery-ui.min.js">
	</script> 
	<script src="plugins/gmap3.min.js">
	</script> 
	<script src="plugins/lightGallery-master/dist/js/lightgallery-all.min.js">
	</script> 
	<script src="plugins/slick/slick/slick.min.js">
	</script> 
	<script src="plugins/slick-animation.min.js">
	</script> 
	<script src="plugins/jquery.slimscroll.min.js">
	</script> <!-- Custom scripts-->
	 
	<script src="js/main.js">
	</script> 
	<script src="http://ditu.google.cn/maps/api/js?key=AIzaSyAckIeA7eVaNv2fKmIKl-udHqlZW2tYxME&region=GB">
	</script> 
</body>
</html>