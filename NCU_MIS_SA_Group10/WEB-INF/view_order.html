<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8">
<![endif]-->
<!--[if IE 9]>
<html class="ie ie9">
<![endif]-->
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<link href="apple-touch-icon.png" rel="apple-touch-icon">
	<link href="favicon.png" rel="icon">
	<meta name="author" content="">
	<meta name="keywords" content="">
	<meta name="description" content="">
	<title>我的訂單</title>
	<script src="https://kit.fontawesome.com/a076d05399.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Kaushan+Script%7CLora:400,700" rel="stylesheet">
	<link rel="stylesheet" href="plugins/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="plugins/bakery-icon/style.css">
	<link rel="stylesheet" href="plugins/bootstrap/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="plugins/owl-carousel/assets/owl.carousel.css">
	<link rel="stylesheet" href="plugins/jquery-bar-rating/dist/themes/fontawesome-stars.css">
	<link rel="stylesheet" href="plugins/bootstrap-select/dist/css/bootstrap-select.min.css">
	<link rel="stylesheet" href="plugins/jquery-ui/jquery-ui.min.css">
	<link rel="stylesheet" href="plugins/slick/slick/slick.css">
	<link rel="stylesheet" href="plugins/lightGallery-master/dist/css/lightgallery.min.css">
	<link rel="stylesheet" href="css/style.css">
	<!-- Dışarıdan Çağırılan Dosyalar Font we Materyal İkonlar -->
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,700' rel='stylesheet' type='text/css'>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<!-- #Dışarıdan Çağırılan Dosyalar Font we Materyal İkonlar Bitiş -->
	<style>
		/*使用google統一字體 https://fonts.google.com/*/
		body {
			font-family: 'Noto Sans TC', sans-serif;
			text-align: center;
		}

		.text {
			font-family: 'Noto Sans TC', sans-serif;
			text-align: center;
		}

		/*表格樣式從這裡開始*/
		table {
			border-collapse: collapse;
			text-align: center;
		}

		/*表頭*/
		table th {
			padding-top: 12px;
			padding-bottom: 12px;
			background-color: rgb(209, 160, 95);
			color: white;
			text-align: center;
		}

		table td,
		table th {
			border: 1px solid #ddd;
			padding: 8px;
		}

		/*表格隔行異色*/
		table tr:nth-child(even) {
			background-color: #f2f2f2;
		}

		/*滑過動畫*/
		table tr:hover {
			background-color: #ddd;
		}

		/*個人資料卡的CSS*/
		#card {
			box-sizing: border-box;
			line-height: 1.2;
			font-family: 'Open Sans', sans-serif;
		}

		.my_text {
			font-family: 'Open Sans', sans-serif;
			text-align: left;
			color: rgb(170, 170, 170);
		}

		.my_card_title {
			font-size: 32px;
		}

		img {
			max-width: 100%;
		}

		.container {
			display: flex;
			align-items: center;
			justify-content: center;
			height: 75vh;
		}

		.my_card {
			position: relative;
			background: #333;
			width: 400px;
			height: 70vh;
			border-radius: 6px;
			padding: 2rem;
			color: #aaa;
			box-shadow: 0 0.25rem 0.25rem rgba(0, 0, 0, 0.2), 0 0 1rem rgba(0, 0, 0, 0.2);
			overflow: hidden;
		}

		.card__image-container {
			margin: -2rem -2rem -2rem -2rem;
		}

		.card__line {
			opacity: 0;
			animation: LineFadeIn .8s .8s forwards ease-in;
		}

		.card__image {
			opacity: 0;
			animation: ImageFadeIn .8s 1.4s forwards;
		}

		.card__title {
			color: white;
			margin-top: 0;
			font-weight: 700;
			letter-spacing: 0.01em;
		}

		.card__content {
			margin-top: -1rem;
			opacity: 0;
			animation: ContentFadeIn .8s 1.6s forwards;
		}

		.card__svg {
			position: absolute;
			left: 0;
			top: 100px;
		}

		@keyframes LineFadeIn {
			0% {
				opacity: 0;
				d: path("M 0 300 Q 0 300 0 300 Q 0 300 0 300 C 0 300 0 300 0 300 Q 0 300 0 300 ");
				stroke: #fff;
			}

			50% {
				opacity: 1;
				d: path("M 0 300 Q 50 300 100 300 Q 250 300 350 300 C 350 300 500 300 650 300 Q 750 300 800 300");
				stroke: #888BFF;
			}

			100% {
				opacity: 1;
				d: path("M -2 100 Q 50 200 100 250 Q 250 400 350 300 C 400 250 550 150 650 300 Q 750 450 802 400");
				stroke: #545581;
			}
		}

		@keyframes ContentFadeIn {
			0% {
				transform: translateY(-1rem);
				opacity: 0;
			}

			100% {
				transform: translateY(0);
				opacity: 1;
			}
		}

		@keyframes ImageFadeIn {
			0% {
				transform: translate(-0.5rem, -0.5rem) scale(1.05);
				opacity: 0;
				filter: blur(2px);
			}

			50% {
				opacity: 1;
				filter: blur(2px);
			}

			100% {
				transform: translateY(0) scale(1);
				opacity: 1;
				filter: blur(0);
			}
		}
	</style>
	<!--HTML5 Shim and Respond.js IE8 support of HTML5 elements and media
queries-->
	<!--WARNING: Respond.js doesn't work if you view the page via file://-->
	<!--[if lt IE 9]>
	<script src="http://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js">
	</script>
	<script src="http://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js">
	</script>
<![endif]-->
	<!--[if IE 7]>
	
	<body class="ie7 lt-ie8 lt-ie9 lt-ie10">
	<![endif]-->
	<!--[if IE 8]>
		
		<body class="ie8 lt-ie9 lt-ie10">
		<![endif]-->
	<!--[if IE 9]>
			
			<body class="ie9 lt-ie10">
			<![endif]-->
</head>

<!-- body的id -->
<!-- id="title": Login, Register, Administrate的標題 -->

<body>
	<!-- Search Icon?-->
	<div class="ps-search">
		<div class="ps-search__content">
			<a class="ps-search__close" href="#">
				<span>
				</span>
			</a>
			<form class="ps-form--search-2" action="do_action" method="post">
				<h3>
					Enter your keyword
				</h3>
				<div class="form-group">
					<input class="form-control" type="text" placeholder="">
					<button class="ps-btn active ps-btn--fullwidth">
						Search
					</button>
				</div>
			</form>
		</div>
	</div>

	<!-- Header-->
	<header class="header header--1" data-sticky="true">
		<nav class="navigation">
			<div class="ps-container">
				<div class="navigation__left">
					<ul class="menu">
						<li><a href="index.html">Home</a></li>
						<li><a href="about.html">Menu</a></li>
						<li><a href="contact.html">Order</a></li>
						<li><a href="#"><i class="ba-profile"></i></a></li>
						</a>
					</ul>
				</div>
			</div>
		</nav>
		<nav class="navigation--mobile">
			<div class="ps-container">
				<a class="ps-logo" href="#">
					<img src="images/logo-light.png" alt="">
				</a>
				<ul class="menu menu--mobile">
					<li><a href="index.html">Home</a></li>
					<li><a href="about.html">Menu</a></li>
					<li><a href="contact.html">Contact</a></li>
				</ul>
				<div class="menu-toggle">
					<span>
					</span>
				</div>
				<div class="header__actions">
					<a class="ps-search-btn" href="#">
						<i class="ba-magnifying-glass">
						</i>
					</a>
					<div class="ps-cart">
						<a class="ps-cart__toggle" href="#">
							<span>
								<i>
									20
								</i>
							</span>
							<i class="ba-shopping">
							</i>
						</a>
						<div class="ps-cart__listing">
							<div class="ps-cart__content">
								<div class="ps-cart-item">
									<a class="ps-cart-item__close" href="#">
									</a>
									<div class="ps-cart-item__thumbnail">
										<a href="#">
										</a>
										<img src="images/shopping-cart/1.png" alt="">
									</div>
									<div class="ps-cart-item__content">
										<a class="ps-cart-item__title" href="#">
											Kingsman
										</a>
										<p>
											<span>
												Quantity:
												<i>
													12
												</i>
											</span>
											<span>
												Total:
												<i>
													£176
												</i>
											</span>
										</p>
									</div>
								</div>
								<div class="ps-cart-item">
									<a class="ps-cart-item__close" href="#">
									</a>
									<div class="ps-cart-item__thumbnail">
										<a href="#">
										</a>
										<img src="images/shopping-cart/2.png" alt="">
									</div>
									<div class="ps-cart-item__content">
										<a class="ps-cart-item__title" href="#">
											Joseph
										</a>
										<p>
											<span>
												Quantity:
												<i>
													12
												</i>
											</span>
											<span>
												Total:
												<i>
													£176
												</i>
											</span>
										</p>
									</div>
								</div>
								<div class="ps-cart-item">
									<a class="ps-cart-item__close" href="#">
									</a>
									<div class="ps-cart-item__thumbnail">
										<a href="#">
										</a>
										<img src="images/shopping-cart/3.png" alt="">
									</div>
									<div class="ps-cart-item__content">
										<a class="ps-cart-item__title" href="#">
											Todd Snyder
										</a>
										<p>
											<span>
												Quantity:
												<i>
													12
												</i>
											</span>
											<span>
												Total:
												<i>
													£176
												</i>
											</span>
										</p>
									</div>
								</div>
								<div class="ps-cart-item">
									<a class="ps-cart-item__close" href="#">
									</a>
									<div class="ps-cart-item__thumbnail">
										<a href="#">
										</a>
										<img src="images/shopping-cart/1.png" alt="">
									</div>
									<div class="ps-cart-item__content">
										<a class="ps-cart-item__title" href="#">
											Todd Snyder
										</a>
										<p>
											<span>
												Quantity:
												<i>
													12
												</i>
											</span>
											<span>
												Total:
												<i>
													£176
												</i>
											</span>
										</p>
									</div>
								</div>
								<div class="ps-cart-item">
									<a class="ps-cart-item__close" href="#">
									</a>
									<div class="ps-cart-item__thumbnail">
										<a href="#">
										</a>
										<img src="images/shopping-cart/1.png" alt="">
									</div>
									<div class="ps-cart-item__content">
										<a class="ps-cart-item__title" href="#">
											Todd Snyder
										</a>
										<p>
											<span>
												Quantity:
												<i>
													12
												</i>
											</span>
											<span>
												Total:
												<i>
													£176
												</i>
											</span>
										</p>
									</div>
								</div>
								<div class="ps-cart-item">
									<a class="ps-cart-item__close" href="#">
									</a>
									<div class="ps-cart-item__thumbnail">
										<a href="#">
										</a>
										<img src="images/shopping-cart/1.png" alt="">
									</div>
									<div class="ps-cart-item__content">
										<a class="ps-cart-item__title" href="#">
											Todd Snyder
										</a>
										<p>
											<span>
												Quantity:
												<i>
													12
												</i>
											</span>
											<span>
												Total:
												<i>
													£176
												</i>
											</span>
										</p>
									</div>
								</div>
							</div>
							<div class="ps-cart__total">
								<p>
									Number of items:
									<span>
										36
									</span>
								</p>
								<p>
									Item Total:
									<span>
										£528.00
									</span>
								</p>
							</div>
							<div class="ps-cart__footer">
								<a href="#">
									Check out
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</nav>
	</header>

	<!-- Member's Info -->
	<div id="card" class="container">
		<div class="my_card">
			<div class="card__image-container">
				<img class="card__image"
					src="https://images.unsplash.com/photo-1519999482648-25049ddd37b1?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=2126&q=80"
					alt="">
			</div>
	
			<svg class="card__svg" viewBox="0 0 800 500">
	
				<path
					d="M 0 100 Q 50 200 100 250 Q 250 400 350 300 C 400 250 550 150 650 300 Q 750 450 800 400 L 800 500 L 0 500"
					stroke="transparent" fill="#333" />
				<path class="card__line"
					d="M 0 100 Q 50 200 100 250 Q 250 400 350 300 C 400 250 550 150 650 300 Q 750 450 800 400" stroke="pink"
					stroke-width="3" fill="transparent" />
			</svg>
	
			<div class="card__content my_text">
				<h2 id="name" class="card__title">sample name</h2>
				<p class="my_text">
					<i class="glyphicon glyphicon-envelope"></i><span> </span><span id="mail">@example.com</span> <br>
					<i class="fas fa-phone"></i><span> </span><span id="phone">sample phone</span> <br>
					<i class="far fa-calendar-alt"></i><span> </span><span id="date">sample date</span> <br>
				</p>
			</div>
		</div>
	</div>

	<!-- Member's Order -->
	<div class="ps-home-blog">
		<div class="ps-container">
			<div class="ps-section__header">
				<h3 class="ps-section__title">
					My Order
				</h3>
				<span>
					<img src="images/icons/floral.png" alt="">
				</span>
				<br><br>

				<!-- Table 會員の歷史訂單，以表格呈現 -->
				<div id="order">
					<table id="tbl_order" style="width:85%">
						<!-- 這裡是表頭 -->
						<thead>
							<tr>
								<th>狀態</th>
								<th>訂單編號</th>
								<th>總價</th>
								<th>訂單資訊</th>
								<th>訂購人資料</th>
							</tr>
						</thead>

						<!-- 動態填入表格 -->
						<tbody>
							<tr>
								<td>進行中</td>
								<td>1</td>
								<td>sample row</td>
								<td>sample row</td>
								<td>sample row</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

		</div>
	</div>

	<footer class="ps-footer">
		<div class="ps-footer__content">
			<div class="ps-container">
				<div class="row">
					<div class="col-lg-4 col-md-12 col-sm-12 col-xs-12 ">
						<div class="ps-site-info">
							<a class="ps-logo" href="index.html">
								<img src="images/logo-dark.png" alt="">
							</a>
							<p>
								Tart bear claw cake tiramisu chocolate bar gummies dragée lemon drops
								brownie.
							</p>
							<ul class="ps-list--social">
								<li>
									<a href="https://www.facebook.com/">
										<i class="fa fa-facebook">
										</i>
									</a>
								</li>
								<li>
									<a href="https://twitter.com/?lang=zh-tw">
										<i class="fa fa-twitter">
										</i>
									</a>
								</li>
								<li>
									<a href="https://dribbble.com">
										<i class="fa fa-dribbble">
										</i>
									</a>
								</li>
							</ul>
						</div>
					</div>
					<div class="col-lg-4 col-md-6 col-sm-12 col-xs-12 ">
						<form class="ps-form--subscribe-offer" action="do_action" method="post">
							<h4>
								Get news & offer
							</h4>
							<div class="form-group">
								<input class="form-control" type="text" placeholder="Your Email...">
								<button onclick="return false;">
									Subscribe
								</button>
							</div>
							<p>
								* Don't worry, we never spam
							</p>
						</form>
						<div class="ps-footer__contact">
							<h4>
								Contact with me
							</h4>
							<p>
								PO Box 16122 Collins Street West,Victoria 8007 Australia
							</p>
							<P>
								(+84 ) 7534 9773, (+84 ) 874 548
							</P>
						</div>
					</div>
					<div class="col-lg-4 col-md-6 col-sm-12 col-xs-12 ">
						<div class="ps-footer__open">
							<h4>
								Time to Open
							</h4>
							<p>
								Monday - Friday:
								<br>
								08:00 am - 08:30 pm
								<br>
								Saturday - Sunday:
								<br>
								10:00 am - 16:30 pm
							</p>
						</div>
						<ul class="ps-list--payment">
							<li>
								<a href="#" onclick="return false;">
									<img src="images/payment-method/visa.png" alt="">
								</a>
							</li>
							<li>
								<a href="#" onclick="return false;">
									<img src="images/payment-method/master-card.png" alt="">
								</a>
							</li>
							<li>
								<a href="#" onclick="return false;">
									<img src="images/payment-method/paypal.png" alt="">
								</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<div class="ps-footer__copyright">
			<div class="container">
				<p>Copyright &copy; 2018.Company name All rights reserved.</p>
			</div>
		</div>
	</footer>

	<div id="back2top">
		<i class="fa fa-angle-up">
		</i>
	</div>

	<!-- javascript從下面開始 -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/js-cookie@beta/dist/js.cookie.min.js"></script>
	<script type="text/javascript">

		$(document).ready(function () {

			// Step1. 從Cookies撈會員個資 > 填上card
			var user_data = Cookies.get("user_data");
			user_data = JSON.parse(user_data);
			$('#name').html(user_data.name);
			$('#mail').html(user_data.email);
			$('#phone').html(user_data.phone);
			$('#date').html(user_data.create);

			// Step2. 從Cookies撈會員訂單 > 填上表格
			var order_data = Cookies.get("order_data");
			order_data = JSON.parse(order_data);
			updateTable(order_data);

		}); // end of ready()

		// 沒用的 如過要從java servlet撈資料寫完這個就好
		function getMemberOrder(id) {
			var data = "";
			// 將資料組成JSON格式 //因應後端，要用js物件
			var data_object = {
				"id": id
			};
			//var data_string = JSON.stringify(data_object); 

			$.ajax({
				type: "GET",
				url: "api/order.do",
				data: data_object,
				crossDomain: true,
				cache: false,
				dataType: 'json',
				timeout: 5000,
				success: function (response) {
					console.log(response);
				},
				error: function (response) {
					console.log(response);
				}
			});
			return data;
		}

		// 沒有用了 當初測試Cookies.get()用的
		function test(){
			var order_data = Cookies.get("order_data");
			order_data = JSON.parse(order_data);
			console.log(order_data);

			$.each(order_data, function (index, value) {
				console.log('index'+index);
				console.log('value');
				console.log(value);
			});
		}

		// 更新訂單表格的方法
		function updateTable(data) {
			// if 交易狀態 0>進行中, 1>已完成
			$("#tbl_order > tbody").empty();

			//一行一行動態插入訂單至tbody
			$.each(data, function (index, value) {

				console.log(value);
				console.log('member_info');
				console.log(value.member_info);
				console.log('order_info');
				console.log(value.order_info);
				console.log('product_info');
				console.log(value.product_info);
				

				let member_info = value.member_info;
				let order_info = value.order_info;
				let product_info = value.product_info;

				let id = order_info.id;
				let status = order_info.order_status == 0 ? "進行中" : "已完成"; //交易狀態 0>進行中, 1>已完成
				let status_flag = order_info.order_status == 0 ? "0" : "1";
				let $stat = $('<span>').text(status);
				let $row = $('<tr>');

				//狀態td + 訂單編號單td
				$row.append($('<td>').append($stat).append(" "));
				$row.append($('<td>').attr({ "id": id }).text(id));


				//總價td
				$row.append($('<td>').text("NT." + order_info.total_price));

				//多個飲料品項的td
				var $items = $('<p>');
				var itemArr = product_info;
				$.each(itemArr, function (i, v) { //需要product_name size ice suger amount
					let $item = $('<div>');
					console.log(v);
					let tea = v.product_name
					$item.append(tea + " " + v.size + " " + v.sugar + v.ice + " x" + v.quantity);
					$items.append($item);

				});

				$row.append($('<td>').append($items));

				//顧客資訊td
				let cust = member_info;
				let $cus = $('<p>')
					.append(cust.name + " id=" + cust.id + "<br>" + cust.phone + "<br>" + order_info.address)
					.addClass('w3-container');
				$row.append($('<td>').append($cus));
				
				$("#tbl_order > tbody").append($row);
			});// end each()

		}// end updateTable()

		function setUserCookie(data, flag_login) {
			var is_admin = { 'flag': false };
			var user_id = data.id;
			var user_phone = data.phone;
			var user_name = data.name;
			var user_data = {
				"user_id": user_id,
				"name": user_name,
				"phone": user_phone,
				"login_fiag": flag_login
			}

			Cookies.set("user_data", JSON.stringify(user_data), { expires: 1, path: '' });
			Cookies.set("is_admin", JSON.stringify(is_admin), { expires: 1, path: '' });
		}

	</script>

	<!-- Plugins-->
	<script src="plugins/jquery/dist/jquery.min.js">
	</script>
	<script src="plugins/bootstrap/dist/js/bootstrap.min.js">
	</script>
	<script src="plugins/owl-carousel/owl.carousel.min.js">
	</script>
	<script src="plugins/bootstrap-select/dist/js/bootstrap-select.min.js">
	</script>
	<script src="plugins/jquery-bar-rating/dist/jquery.barrating.min.js">
	</script>
	<script src="plugins/jquery.waypoints.min.js">
	</script>
	<script src="plugins/jquery.countTo.js">
	</script>
	<script src="plugins/jquery.matchHeight-min.js">
	</script>
	<script src="plugins/jquery-ui/jquery-ui.min.js">
	</script>
	<script src="plugins/gmap3.min.js">
	</script>
	<script src="plugins/lightGallery-master/dist/js/lightgallery-all.min.js">
	</script>
	<script src="plugins/slick/slick/slick.min.js">
	</script>
	<script src="plugins/slick-animation.min.js">
	</script>
	<script src="plugins/jquery.slimscroll.min.js">
	</script>
	<!-- Custom scripts-->
	<script src="js/main.js">
	</script>
	<script src="http://ditu.google.cn/maps/api/js?key=AIzaSyAckIeA7eVaNv2fKmIKl-udHqlZW2tYxME&region=GB">
	</script>
</body>

</html>